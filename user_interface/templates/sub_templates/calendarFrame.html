
{% load static %}
<script src="{% static 'user_interface/js/renderCalendar.js' %}"> </script>
<script src="{% static 'user_interface/js/Calender.js' %}"> </script>
<link rel="stylesheet" href="{% static 'user_interface/css/calendar.css' %}">
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

<div class="container calCont" style="width:100%;">
	  	<div id="cal_control_bar">
	  		<nav class="navbar navbar-expand navbar-dark bg-dark" style="z-index: 21;">
		      	<ul class= "navbar-nav ml-auto">
			        <li class="nav-item" onclick="leftArrowClick()">
			          <a class="nav-link" href="#" id="prev_button"><i class="material-icons left">arrow_left</i></a>
			        </li>
			        <li class="nav-item" onclick="currButtonClick()">
			          <a class="nav-link" href="#" id="curr_button"><i class="material-icons left">fiber_manual_record</i></a>
			        </li>
			        <li class="nav-item" onclick="rightArrowClick()">
			          <a class="nav-link" href="#" id="next_button"><i class="material-icons left">arrow_right</i></a>
			        </li>
		        </ul>
		      <div class="collapse navbar-collapse" id="collapsableNav">
		        <ul class="navbar-nav mx-auto">
		          <li class="nav-item">
		            <div class="monthBar justify-content-center" style="">
					  <select class="monthSel" id="month_sel" data-style="monthSel" onchange="monthYearUpdate();">
					  </select>
					</div>
		          </li>
		          <li class="nav-item">
		            <div class="dayBar justify-content-center" style="">
					  <select class="daySel" id="day_sel" data-style="daySel" onchange="dayWeekUpdate();">
					  </select>
					</div>
		          </li>
		          <li class="nav-item">
		            <div class="yearBar justify-content-center" style="">
					  <select class="yearSel" id="year_sel" data-style="yearSel" onchange="monthYearUpdate();">
					  </select>
					</div>
		          </li>
		        </ul>
		        
		        <ul class= "navbar-nav ml-auto">
		        	<li class="nav-item dropdown overAll">
			            <a class="nav-link" href="http://example.com" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">View</a>
			            	<div class="dropdown-menu dropdown-menu-right" style="position:absolute; z-index: 100; color:black; " aria-labelledby="dropdown04">
			            	
			            	<a class="dropdown-item" href="#" onclick="switchCalendarView('cal_grid_cont', 'month');" id="month_button" aria-expanded="false">Month</a>
			            	<a class="dropdown-item" href="#" onclick="switchCalendarView('cal_grid_cont', 'week');" id="week_button" aria-expanded="false">Week</a>
			            	<a class="dropdown-item" href="#" onclick="switchCalendarView('cal_grid_cont', 'day');" id="day_button" aria-expanded="false">Day</a>
			            	<a class="dropdown-item" href="#" onclick="switchCalendarView('cal_grid_cont', 'list');" id="list_button" aria-expanded="false">List</a>
			            	</div>
			            </div>
			          </li>
		        </ul>
		      </div>
		    </nav>
	  	<div>
	  	<div id="sub_control_bar">
	  		<nav class="navbar navbar-expand navbar-dark bg-dark" style="z-index: 20;">
		      	<ul class= "navbar-nav ml-auto">
			        <li class="nav-item" style="color: white; padding-top:15px">
			        	Freetime
			        </li>
			        <li style="padding-left:15px;">
		        	<label class="switch">
					  <input type="checkbox" onclick="switchTest()" id="freetimeChecked">
					  <span class="slider round" ></span>
					</label>
					<script type="text/javascript">
						function switchTest(){
							if(window.scrollY != 0){
								_prev_scroll_y = window.scrollY;
							}
							freetimeChecked = !freetimeChecked;
							if(_switchType == "list" || _switchType == "month"){
								switchCalendarView(_cont_id, _switchType);
							}
							smoothScrollTo();
						}
					</script>
					</li>
					<li style="padding-left:30px;">
						<div class="dropdown" >
						  <button class="btn btn-secondary dropdown-toggle" type="button" id="members_select_dropdown_button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="padding-top: 16px; color:white;">
						    Friends
						  </button>
						  <div class="dropdown-menu friendsSelectDropdown overAll" aria-labelledby="members_select_dropdown_button"
						  	style="position:absolute; z-index: 20;"
						  >
						  	<form id="members_select_dropdown" style="z-index: 20;">
							</form>
						  </div>
						</div>
					</li>
		        </ul>
		      <div class="collapse navbar-collapse" id="sub_control_bar_nav">
		        <ul class="navbar-nav mr-auto">
		        </ul>
		        <ul class="navbar-nav">
		          <li class="nav-item">
		            <div class="monthBar justify-content-center" style="">
					</div>
		          </li>
		          <li class="nav-item">
		            <div class="dayBar justify-content-center" style="">
					</div>
		          </li>
		          <li class="nav-item">
		            <div class="yearBar justify-content-center" style="">
					</div>
		          </li>
		        </ul>
		        
		        <ul class= "navbar-nav ml-auto">
		          <li class="nav-item">
					<a class="nav-link" href="#" id="create_event_button"><i class="material-icons left" data-toggle="modal" data-target="#createEventModal">add_circle_outline</i></a>
		          </li>
		        </ul>
		      </div>
		    </nav>
	  	<div>

	  	<div id="cal_top_head">
	  	</div>
	  	<div id="cal_grid_cont" style="padding-top: 20px; padding-bottom: 100px;">
	  		
			  	</div>
	</div>
	<div class="modal fade" id="createEventModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="createEventModalLongTitle">Create a New Event</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
			  	<div class="form-group">
				    <label class="reqField" for="inputEventName">Event Name</label>
				    <input onchange="updateEventForm()" type="text" class="form-control" id="inputEventName" pattern="^[a-zA-Z0-9 ]*$" required>
				</div>
			  	<div class="form-group">
				    <label for="inputEventDesc">Description</label>
				    <input onchange="updateEventForm()" type="text" class="form-control" id="inputEventDesc" pattern="^[a-zA-Z0-9 ]*$">
				</div>
				<div class="form-row">
				  <div class="form-group col-md-6">
				    <label class="reqField" for="inputStartDate">Start Date</label>
				    <input onchange="updateEventForm()" class="form-control" type="date" id="inputStartDate" pattern="(?n:^(?=\d)((?<month>(0?[13578])|1[02]|(0?[469]|11)(?!.31)|0?2(?(.29)(?=.29.((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|(16|[2468][048]|[3579][26])00))|(?!.3[01])))(?<sep>[-./])(?<day>0?[1-9]|[12]\d|3[01])\k<sep>(?<year>(1[6-9]|[2-9]\d)\d{2})(?(?=\x20\d)\x20|$))?(?<time>((0?[1-9]|1[012])(:[0-5]\d){0,2}(?i:\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$)$" required>
				  </div>	
				  <div class="form-group col-md-6">
				    <label class="reqField" for="inputEndDate">End Date</label>
				    <input onchange="updateEventForm()" class="form-control" type="date" id="inputEndDate" pattern="(?n:^(?=\d)((?<month>(0?[13578])|1[02]|(0?[469]|11)(?!.31)|0?2(?(.29)(?=.29.((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|(16|[2468][048]|[3579][26])00))|(?!.3[01])))(?<sep>[-./])(?<day>0?[1-9]|[12]\d|3[01])\k<sep>(?<year>(1[6-9]|[2-9]\d)\d{2})(?(?=\x20\d)\x20|$))?(?<time>((0?[1-9]|1[012])(:[0-5]\d){0,2}(?i:\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$)$" required>
				  </div>
				</div>
				<div class="form-row">
				  <div class="form-group col-md-6">
				    <label class="reqField" for="inputStartTime">Start Time</label>
				    <input onchange="updateEventForm()" class="form-control" type="time" id="inputStartTime" required>
				  </div>	
				  <div class="form-group col-md-6">
				    <label class="reqField" for="inputEndTime">End Time</label>
				    <input onchange="updateEventForm()" class="form-control" type="time" id="inputEndTime" required>
				  </div>
				</div>
				<div class="form-text">
				    <label for="inputInviteList">Invite</label>
				    <div class="dropdown" >
					  <button class="btn btn-secondary dropdown-toggle" type="button" id="invites_select_dropdown_button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: black;">
					    <div id="inviteNameId" style="color:black;">
					    	Select members to invite...
					    </div>
					  </button>
					  <div class="dropdown-menu friendsSelectDropdown overAll" aria-labelledby="invites_select_dropdown_button"
					  	style="position:absolute; z-index: 20;" id="invites_select_dropdown">
					  </div>
					</div>
				</div>
				<script type="text/javascript">
							$(document).ready(function() {
							  populateInviteSelectDropdown();
							  populateWhitelistSelectDropdown();
							  populateBlacklistSelectDropdown();
							});
							var invite_ids = [];
							function populateInviteSelectDropdown(){
								var friends_to_pop = _calendar_struct.calendar_data.member_info;
								var invitesSelectDropdown = document.getElementById("invites_select_dropdown");
								for(var i = 0; i < friends_to_pop.length; i++){
									var curr_friend = friends_to_pop[i];
									var curr_a = document.createElement("a");
									curr_a.className = "dropdown-item";
									var temp_id = curr_friend.alias + "_check_i";
									curr_a.href = "#";
									curr_a.setAttribute("onclick", "checkInviteSelect('" + temp_id + "')");
									var curr_label = document.createElement("label");
									curr_label.className = "check_container";
									curr_label.innerText = curr_friend.first_name + " " + curr_friend.last_name;
									var curr_input = document.createElement("input");
									curr_input.type = "checkbox";
									curr_input.id = temp_id;
									curr_input.setAttribute("alias", curr_friend.alias);
									var curr_span = document.createElement("span");
									curr_span.className = "checkmark";
									curr_label.appendChild(curr_input);
									curr_label.appendChild(curr_span);
									curr_a.appendChild(curr_label);
									var temp_form = document.createElement('form');
									temp_form.appendChild(curr_a);
									invitesSelectDropdown.appendChild(temp_form);
									invite_ids.push({"check_id" : temp_id, "alias" : curr_friend.alias, "firebase_id" : curr_friend.firebase_id});
								}
							}
							function checkInviteSelect(sel_id){
								var check_input = document.getElementById(sel_id);
								if(check_input.checked){
									check_input.checked = false;
									check_input.setAttribute("flag", "false");
								}else{
									check_input.checked = true;
									check_input.setAttribute("flag", "true");
								}
								var inviteTitle = document.getElementById("inviteNameId");
								var str_place = "";
								var invitesSelected = getInvitesSelected();
								for(var i = 0; i < invitesSelected.length; i++){
									str_place += "@" + invitesSelected[i];
									if(i != invitesSelected.length - 1){
										str_place += ", ";
									}
								}
								inviteTitle.innerText = str_place;
								if(str_place == ""){
									inviteTitle.innerText = 'Select members to invite...'
								}
							}
							function getInvitesSelected(){
								var valid = [];
								for(var i = 0; i < invite_ids.length; i++){
									var curr_div = document.getElementById(invite_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(invite_ids[i].alias);
									}
								}
								return valid;
							}
							function getInvitesSelectedFirebase(){
								var valid = [];
								for(var i = 0; i < invite_ids.length; i++){
									var curr_div = document.getElementById(invite_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(invite_ids[i].firebase_id);
									}
								}
								return valid;
							}

						</script>
				  <div class="form-group">
				    <label for="inputWhitelist">Whitelist</label>
				    <!-- <input onchange="updateEventForm()" type="text" class="form-control" id="inputWhitelist" pattern="(^$)|[0-9a-zA-Z]+(,[0-9a-zA-Z]+)*$"> -->
				    <div class="dropdown" >
					  <button class="btn btn-secondary dropdown-toggle" type="button" id="whitelist_select_dropdown_button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: black;">
					    <div id="whitelistNameId" style="color:black;">
					    	Select members to Whitelist...
					    </div>
					  </button>
					  <div class="dropdown-menu friendsSelectDropdown overAll" aria-labelledby="whitelist_select_dropdown_button"
					  	style="position:absolute; z-index: 20;" id="whitelist_select_dropdown">
					  </div>
					</div>
					<script type="text/javascript">
						var whitelist_ids = [];

						function populateWhitelistSelectDropdown(){
								var friends_to_pop = _calendar_struct.calendar_data.member_info;
								var whitelistSelectDropdown = document.getElementById("whitelist_select_dropdown");
								for(var i = 0; i < friends_to_pop.length; i++){
									var curr_friend = friends_to_pop[i];
									var curr_a = document.createElement("a");
									curr_a.className = "dropdown-item";
									var temp_id = curr_friend.alias + "_check_w";
									curr_a.href = "#";
									curr_a.setAttribute("onclick", "checkWhitelistSelect('" + temp_id + "')");
									var curr_label = document.createElement("label");
									curr_label.className = "check_container";
									curr_label.innerText = curr_friend.first_name + " " + curr_friend.last_name;
									var curr_input = document.createElement("input");
									curr_input.type = "checkbox";
									curr_input.id = temp_id;
									curr_input.setAttribute("alias", curr_friend.alias);
									var curr_span = document.createElement("span");
									curr_span.className = "checkmark";
									curr_label.appendChild(curr_input);
									curr_label.appendChild(curr_span);
									curr_a.appendChild(curr_label);
									var temp_form = document.createElement('form');
									temp_form.appendChild(curr_a);
									whitelistSelectDropdown.appendChild(temp_form);
									whitelist_ids.push({"check_id" : temp_id, "alias" : curr_friend.alias, "firebase_id" : curr_friend.firebase_id});
								}
							}
							function checkWhitelistSelect(sel_id){
								var check_input = document.getElementById(sel_id);
								if(check_input.checked){
									check_input.checked = false;
									check_input.setAttribute("flag", "false");
								}else{
									check_input.checked = true;
									check_input.setAttribute("flag", "true");
								}
								var whitelistTitle = document.getElementById("whitelistNameId");
								var str_place = "";
								var whitelistSelected = getWhitelistSelected();
								for(var i = 0; i < whitelistSelected.length; i++){
									str_place += "@" + whitelistSelected[i];
									if(i != whitelistSelected.length - 1){
										str_place += ", ";
									}
								}
								whitelistTitle.innerText = str_place;
								if(str_place == ""){
									whitelistTitle.innerText = 'Select members to Whitelist...'
								}
							}

							function getWhitelistSelected(){
								var valid = [];
								for(var i = 0; i < whitelist_ids.length; i++){
									var curr_div = document.getElementById(whitelist_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(whitelist_ids[i].alias);
									}
								}
								return valid;
							}
							function getWhitelistSelectedFirebase(){
								var valid = [];
								for(var i = 0; i < whitelist_ids.length; i++){
									var curr_div = document.getElementById(whitelist_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(whitelist_ids[i].firebase_id);
									}
								}
								return valid;
							}
						
					</script>
				  </div>	
				  <div class="form-group">
				    <label for="inputBlacklist">Blacklist</label>
				    <!-- <input onchange="updateEventForm()" type="text" class="form-control" id="inputBlacklist" pattern="(^$)|[0-9a-zA-Z]+(,[0-9a-zA-Z]+)*$"> -->
				    <div class="dropdown" >
					  <button class="btn btn-secondary dropdown-toggle" type="button" id="blacklist_select_dropdown_button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: black;">
					    <div id="blacklistNameId" style="color:black;">
					    	Select members to Blacklist...
					    </div>
					  </button>
					  <div class="dropdown-menu friendsSelectDropdown overAll" aria-labelledby="blacklist_select_dropdown_button"
					  	style="position:absolute; z-index: 20;" id="blacklist_select_dropdown">
					  </div>
					</div>
					<script type="text/javascript">
						var blacklist_ids = [];

						function populateBlacklistSelectDropdown(){
								var friends_to_pop = _calendar_struct.calendar_data.member_info;
								var blacklistSelectDropdown = document.getElementById("blacklist_select_dropdown");
								for(var i = 0; i < friends_to_pop.length; i++){
									var curr_friend = friends_to_pop[i];
									var curr_a = document.createElement("a");
									curr_a.className = "dropdown-item";
									var temp_id = curr_friend.alias + "_check_b";
									curr_a.href = "#";
									curr_a.setAttribute("onclick", "checkBlacklistSelect('" + temp_id + "')");
									var curr_label = document.createElement("label");
									curr_label.className = "check_container";
									curr_label.innerText = curr_friend.first_name + " " + curr_friend.last_name;
									var curr_input = document.createElement("input");
									curr_input.type = "checkbox";
									curr_input.id = temp_id;
									curr_input.setAttribute("alias", curr_friend.alias);
									var curr_span = document.createElement("span");
									curr_span.className = "checkmark";
									curr_label.appendChild(curr_input);
									curr_label.appendChild(curr_span);
									curr_a.appendChild(curr_label);
									var temp_form = document.createElement('form');
									temp_form.appendChild(curr_a);
									blacklistSelectDropdown.appendChild(temp_form);
									blacklist_ids.push({"check_id" : temp_id, "alias" : curr_friend.alias, "firebase_id" : curr_friend.firebase_id});
								}
							}
							function checkBlacklistSelect(sel_id){
								var check_input = document.getElementById(sel_id);
								if(check_input.checked){
									check_input.checked = false;
									check_input.setAttribute("flag", "false");
								}else{
									check_input.checked = true;
									check_input.setAttribute("flag", "true");
								}
								var blacklistTitle = document.getElementById("blacklistNameId");
								var str_place = "";
								var blacklistSelected = getBlacklistSelected();
								for(var i = 0; i < blacklistSelected.length; i++){
									str_place += "@" + blacklistSelected[i];
									if(i != blacklistSelected.length - 1){
										str_place += ", ";
									}
								}
								blacklistTitle.innerText = str_place;
								if(str_place == ""){
									blacklistTitle.innerText = 'Select members to Whitelist...'
								}
							}

							function getBlacklistSelected(){
								var valid = [];
								for(var i = 0; i < blacklist_ids.length; i++){
									var curr_div = document.getElementById(blacklist_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(blacklist_ids[i].alias);
									}
								}
								return valid;
							}
							function getBlacklistSelectedFirebase(){
								var valid = [];
								for(var i = 0; i < blacklist_ids.length; i++){
									var curr_div = document.getElementById(blacklist_ids[i].check_id);
									if(curr_div.getAttribute("flag") == "true"){
										valid.push(blacklist_ids[i].firebase_id);
									}
								}
								return valid;
							}
					</script>
				  </div>
				<div class="form-row">
				  <div class="form-group col-md-6">
				    <label for="doRepeatSwitch">Repeat</label>
				    <div id="doRepeatSwitch" style="padding-left: 0px;">
				    <label class="switch" id="doRepeatSwitch">
					  <input type="checkbox" onclick="repeatClicked()" id="repeatToggler">
					  <span class="slider round"></span>
					</label>
					<script type="text/javascript">
						_repeatClicked = false;
						function repeatClicked(){
							_repeatClicked = !_repeatClicked;
							var hiddenPattern = document.getElementById("patternHider");
							if(_repeatClicked){
								hiddenPattern.style.display = "block";
							}else{
								hiddenPattern.style.display = "none";

							}
							updateEventForm();
						}
					</script>
					</div>
				  </div>
				  <div class="form-group col-md-6" id="patternHider" style="display: none;">
				    <label class="reqField" for="repeatPattern" >Repeat Pattern</label>
				    <div id="repeatPattern" style="">
					    <label for="checkSunday">Su</label>
					    <label for="checkMonday">&nbspMo</label>
					    <label for="checkTuesday">&nbspTu</label>
					    <label for="checkWednesday">&nbsp&nbspWe</label>
					    <label for="checkThursday">&nbspTh</label>
					    <label for="checkFriday">&nbsp&nbspFr</label>
					    <label for="checkSaturday">&nbspSa</label>
					    <br>
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkSunday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkMonday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkTuesday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkWednesday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkThursday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkFriday">
						    <input type="checkbox" onclick="updateEventForm()" style="width: 25px; transform: scale(2);" name="" id="checkSaturday">
					</div>
				  </div>
				</div>
			  	<input type="button" class="confirmButton" style="width:100%; height:50px;" onclick="updateAndSubmit()" value="Create Event">
				<script type="text/javascript">
					function updateEventForm(){
						// Event Name
						var enter_name = document.getElementById("inputEventName");
						var form_name = document.getElementById("id_EIname");
						form_name.value = enter_name.value;
						var enter_desc = document.getElementById("inputEventDesc");
						var form_desc = document.getElementById("id_EIdescription");
						form_desc.value = enter_desc.value;

						var enter_start_date = document.getElementById("inputStartDate");
						var enter_start_time = document.getElementById("inputStartTime");
						
						var form_start = document.getElementById("id_EIstart");
						var start_date_day = new Date(enter_start_date.value + " " + enter_start_time.value);
						form_start.value = start_date_day.getTime() + "";
						// console.log(form_start);
						// ADD DATE FORMATTING

						// form_start.value = enter_start.value;
						var enter_end_date = document.getElementById("inputEndDate");
						var enter_end_time = document.getElementById("inputEndTime");
						var form_end = document.getElementById("id_EIend");
						var end_date_day = new Date(enter_end_date.value + " " + enter_end_time.value);
						form_end.value = end_date_day.getTime() + "";
						// console.log(form_end);
						// ADD DATE FORMATTING

						// form_end.value = enter_end.value;
						var form_repeat = document.getElementById("id_EIrepeat");
						form_repeat.value = _repeatClicked + "";

						var form_repeat_pattern = document.getElementById("id_EIrepeat_pattern");
						var pattern_str = "";
						var check_su = document.getElementById("checkSunday");
						pattern_str += (check_su.checked ? "1" : 0);
						var check_mo = document.getElementById("checkMonday");
						pattern_str += (check_mo.checked ? "1" : 0);
						var check_tu = document.getElementById("checkTuesday");
						pattern_str += (check_tu.checked ? "1" : 0);
						var check_we = document.getElementById("checkWednesday");
						pattern_str += (check_we.checked ? "1" : 0);
						var check_th = document.getElementById("checkThursday");
						pattern_str += (check_th.checked ? "1" : 0);
						var check_fr = document.getElementById("checkFriday");
						pattern_str += (check_fr.checked ? "1" : 0);
						var check_sa = document.getElementById("checkSaturday");
						pattern_str += (check_sa.checked ? "1" : 0);
						form_repeat_pattern.value = pattern_str;

						// Invites
						// var enter_invite = document.getElementById("inputInviteList");
						var form_invite = document.getElementById("id_EIinvite");
						var invite_string = "";
						var invite_sel = getInvitesSelectedFirebase();
						for(var i = 0; i < invite_sel.length; i++){
							invite_string += invite_sel[i];
							if(i != invite_sel.length - 1){
								invite_string += ",";
							}
						}
						form_invite.value = invite_string;

						// Whitelist
						// var enter_whitelist = document.getElementById("inputWhitelist");
						var form_whitelist = document.getElementById("id_EIwhitelist");
						var whitelist_string = "";
						var whitelist_sel = getWhitelistSelectedFirebase();
						for(var i = 0; i < whitelist_sel.length; i++){
							whitelist_string += whitelist_sel[i];
							if(i != whitelist_sel.length - 1){
								whitelist_string += ",";
							}
						}
						form_whitelist.value = whitelist_string;

						// Blacklist
						// var enter_blacklist = document.getElementById("inputBlacklist");
						var form_blacklist = document.getElementById("id_EIblacklist");
						var blacklist_string = "";
						var blacklist_sel = getBlacklistSelectedFirebase();
						for(var i = 0; i < blacklist_sel.length; i++){
							blacklist_string += blacklist_sel[i];
							if(i != blacklist_sel.length - 1){
								blacklist_string += ",";
							}
						}
						form_blacklist.value = blacklist_string;
					}
					function validEventForm(){
						var form_name = document.getElementById("id_EIname");
						if(form_name.value == ""){
							return false;
						}
						var form_start = document.getElementById("id_EIstart");
						if(form_start.value == "" || form_start.value == "NaN"){
							return false;
						}
						var form_end = document.getElementById("id_EIend");
						if(form_end.value == "" || form_end.value == "NaN"){
							return false;
						}
						return true;
					}

					function updateAndSubmit(){
						updateEventForm();
						if(validEventForm() == true){
							var submitButton = document.getElementById("createEventHidden");
							submitButton.click();
						}
					}
				</script>

	        <form action="/profile/" method="post">
				{% csrf_token %}
				{{ calendar_forms.event_form.as_ul }}
				<input type="hidden" name="formType" value="SubmitEvent">
				<input type="submit"  style="display: none;" id="createEventHidden">
			</form>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="" href="#" id="viewEventsOpenButton" data-toggle="modal" data-target="#viewEventsModal" style="display:none;"></div>
	<div class="modal fade" id="viewEventsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="viewEventsModalLongTitle">View Events Selected</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <form>
				<div class="dropdown-divider"></div>
				<div class="form-group">
					<div id="viewEventsScrollCont" style="height:400px; width:100%; overflow-y: scroll;">
					</div>
				</div>
				</form>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="" href="#" id="viewSelectEventButton" data-toggle="modal" data-target="#viewSelectEventModal" style="display:none;"></div>
	<div class="modal fade" id="viewSelectEventModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="viewSelectEventModalLongTitle">View Event Selected</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
		  	<div class="form-group">
			    <label class="" for="displayEventName" style="font-size: 20;">Event Name</label>
			    <div id="displayEventName">  </div>
			</div>
			<div class="form-group">
			    <label class="" for="displayEventDescription" style="font-size: 20;">Event Description</label>
			    <div id="displayEventDescription">  </div>
			</div>
			<div class="form-group">
			    <label class="" for="displayEventStart" style="font-size: 20;">Start</label>
			    <div id="displayEventStart">  </div>
			</div>
			<div class="form-group">
			    <label class="" for="displayEventEnd" style="font-size: 20;">End</label>
			    <div id="displayEventEnd"> </div>
			</div>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="" href="#" id="viewEditEventButton" data-toggle="modal" data-target="#viewEditEventModal" style="display:none;"></div>
	<div class="modal fade" id="viewEditEventModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="viewEditEventModalLongTitle">Edit Event Selected</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div class="form-group">
			    <label class="reqField" for="inputEditEventName">Event Name</label>
			    <input onchange="updateEditEventForm()" type="text" class="form-control" id="inputEditEventName" pattern="^[a-zA-Z0-9 ]*$" required>
			</div>
	        <div class="form-group">
			    <label for="inputEditEventDesc">Description</label>
			    <input onchange="updateEditEventForm()" type="text" class="form-control" id="inputEditEventDesc" pattern="^[a-zA-Z0-9 ]*$">
			</div>
			<div class="form-row">
			  <div class="form-group col-md-6">
			    <label class="reqField" for="inputEditStartDate">Start Date</label>
			    <input onchange="updateEditEventForm()" class="form-control" type="date" id="inputEditStartDate" pattern="(?n:^(?=\d)((?<month>(0?[13578])|1[02]|(0?[469]|11)(?!.31)|0?2(?(.29)(?=.29.((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|(16|[2468][048]|[3579][26])00))|(?!.3[01])))(?<sep>[-./])(?<day>0?[1-9]|[12]\d|3[01])\k<sep>(?<year>(1[6-9]|[2-9]\d)\d{2})(?(?=\x20\d)\x20|$))?(?<time>((0?[1-9]|1[012])(:[0-5]\d){0,2}(?i:\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$)$" required>
			  </div>	
			  <div class="form-group col-md-6">
			    <label class="reqField" for="inputEditEndDate">End Date</label>
			    <input onchange="updateEditEventForm()" class="form-control" type="date" id="inputEditEndDate" pattern="(?n:^(?=\d)((?<month>(0?[13578])|1[02]|(0?[469]|11)(?!.31)|0?2(?(.29)(?=.29.((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|(16|[2468][048]|[3579][26])00))|(?!.3[01])))(?<sep>[-./])(?<day>0?[1-9]|[12]\d|3[01])\k<sep>(?<year>(1[6-9]|[2-9]\d)\d{2})(?(?=\x20\d)\x20|$))?(?<time>((0?[1-9]|1[012])(:[0-5]\d){0,2}(?i:\x20[AP]M))|([01]\d|2[0-3])(:[0-5]\d){1,2})?$)$" required>
			  </div>
			</div>
			<div class="form-row">
			  <div class="form-group col-md-6">
			    <label class="reqField" for="inputEditStartTime">Start Time</label>
			    <input onchange="updateEditEventForm()" class="form-control" type="time" id="inputEditStartTime" required>
			  </div>	
			  <div class="form-group col-md-6">
			    <label class="reqField" for="inputEditEndTime">End Time</label>
			    <input onchange="updateEditEventForm()" class="form-control" type="time" id="inputEditEndTime" required>
			  </div>
			</div>
			<input type="button" class="confirmButton" style="width:100%; height:50px;" onclick="updateAndSubmitEdit()" value="Submit Changes">
	      </div>
	    </div>
	  </div>
	  <script type="text/javascript">
		  	function updateEditEventForm(){
				var enter_name = document.getElementById("inputEditEventName");
				var form_name = document.getElementById("id_EIeditname");
				form_name.value = enter_name.value;
				var enter_desc = document.getElementById("inputEditEventDesc");
				var form_desc = document.getElementById("id_EIeditdescription");
				form_desc.value = enter_desc.value;

				var enter_start_date = document.getElementById("inputEditStartDate");
				var enter_start_time = document.getElementById("inputEditStartTime");
				
				var form_start = document.getElementById("id_EIeditstart");
				var start_date_day = new Date(enter_start_date.value + " " + enter_start_time.value);
				form_start.value = start_date_day.getTime() + "";
				// console.log(form_start);
				// ADD DATE FORMATTING

				// form_start.value = enter_start.value;
				var enter_end_date = document.getElementById("inputEditEndDate");
				var enter_end_time = document.getElementById("inputEditEndTime");
				var form_end = document.getElementById("id_EIeditend");
				var end_date_day = new Date(enter_end_date.value + " " + enter_end_time.value);
				form_end.value = end_date_day.getTime() + "";
		  	}
		  	function validEditEventForm(){
		  		return true;
		  	}
		  	function updateAndSubmitEdit(){
				updateEditEventForm();
				if(validEditEventForm() == true){
					var submitButton = document.getElementById("editEventSubmitHidden");
					submitButton.click();
				}
			}
	  </script>
	</div>
	<form action="/profile/" method="post">
		{% csrf_token %}
		{{ calendar_forms.edit_event_form.as_ul }}
		<input type="hidden" name="formType" value="SubmitEditEvent">
		<input type="submit"  style="display: none;" id="editEventSubmitHidden">
	</form>

	<div style="display:none;" onclick="loadCalendarFrame()" id="loadCalendarFrameID"></div>

	<script type="text/javascript">
		var database_calendar_struct = parseQuotesJson("{{database_calendar_dict}}");
		console.log("database_calendar_struct", database_calendar_struct);
		function loadCalendarFrame(){
			main_renderCalendar(database_calendar_struct);
		}
	</script>
